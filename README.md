Компоненты музыки {#компоненты-музыки .unnumbered}
=================

В рамках предложенного алгоритма выделим мелодию и гармонию из всех
средств музыкалой вы- разительности и будем рассматривать их генерацию
на основе данного музыкального произведения.

Выделение мелодии и гармонии {#выделение-мелодии-и-гармонии .unnumbered}
============================

Первый шаг будет заключаться в выделении мелодии и гармонии из
музыкального произведения. Тут и далее будем рассматривать представлние
аудиофайлов в midi формате. Рассмотрим множе- ство всех нот
$\Omega = \{\omega_{1} \ldots \omega_{127}\}$, и группы нот
$W_{i} = \{\omega_{j} \ | \ j \equiv i \mod 12\}, i \in \{0 \ldots 11\}$.
Отождествле- ние нот по модулю 12 разумно, так как октава состоит в
точности из 12 нот.

Аккорды {#аккорды .unnumbered}
-------

Теперь в каждый фиксированный момент $t$ музыку можно описать вектором
$v_t$ размерности $12$. $i$-ая компонента вектора будет отвечать
суммарной громкости группы нот $W_{i}$ в момент $t$. Вектор $v_t$ будем
называть аккордом, соотвествующим времени $t$.

Выделение последовательности аккордов {#выделение-последовательности-аккордов .unnumbered}
-------------------------------------

Процесс преобразования аудиофайла в последовательность аккордов будем
называть выделенем мелодии и гармонии. Заметим также, что каждому
аудиофайлу можно сопоставить конечную по- следовательность векторов
$V = \{v_{t_0} \ldots v_{t_n}\}$, где моменты времени $t_0 \ldots t_n$
отвечают смене аккорда.

Графы {#графы .unnumbered}
=====

Рассмотрим неоринтированный граф
$G = \{V, E\}, E = \Big\{(v_{t_i}, v_{t_{i+1}}) \ | \ i \in \{0 \ldots n - 1\}\Big\}$.
В текущей версии вес ребра $(v_{t_i}, v_{t_{i+1}})$ определяется
евклидовой нормой разности $v_{t_i} - v_{t_{i+1}}$. Попробуем решить
задачу китайского почтальона на построенном графе. Задача заключается в
поиске кратчайшего замкнутого пути или цикла, который проходит через
каждое ребро связного взвешенного неориен- тированного графа. Если граф
имеет эйлеров цикл, тогда этот цикл служит оптимальным решением. В
противном случае задачей оптимизации является поиск подмножества рёбер с
минимальным воз- можным общим весом, так что после из добавления
получающийся мультиграф имел эйлеров цикл. Эта задача может быть решена
за полиномиальное время.

Сравнение результатов {#сравнение-результатов .unnumbered}
=====================

Примечательно, что изначально построенная последовательность
$\{v_{t_0} \ldots v_{t_n}, v_{t_0}\}$ также является решением задачи
добавления ребер в граф $G$ для существования эйлерова цикла нем. Более
того, такое решение оказывается близким к оптимальному на примере
рассмотренных мной аудиофайлов.

Cоздание новой версии мелодии и гармонии {#cоздание-новой-версии-мелодии-и-гармонии .unnumbered}
========================================

После решения задачи китайского почтальона преобразуем найденный эйлеров
цикл, представляю- щий собой последовательность аккордов, в midi файл
**recreated-harmony.mid**. Это же сделаем с изначально построенной
последовательностью $V$ , в результате получив midi файл
**harmony.mid**.
